function CCreditsPanel(){var e,t,i,n,o,s,a,r,l,c;this._init=function(){c=new createjs.Container,s_oStage.addChild(c);var h=new createjs.Shape;h.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),h.alpha=.5,c.addChild(h);var _=s_oSpriteLibrary.getSprite("msg_box");e=createBitmap(_),c.addChild(e),e.x=.5*CANVAS_WIDTH,e.y=.5*CANVAS_HEIGHT,e.regX=.5*_.width,e.regY=.5*_.height,s=new createjs.Shape,s.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),s.alpha=.01,s.on("click",this._onLogoButRelease),s_bMobile||(s.cursor="pointer"),c.addChild(s);var u=s_oSpriteLibrary.getSprite("but_exit");l={x:880,y:210},i=new CGfxButton(l.x,l.y,u,c),i.addEventListener(ON_MOUSE_UP,this.unload,this),o=new createjs.Text(TEXT_CREDITS_DEVELOPED,"28px "+FONT_GAME,"#000"),o.textAlign="center",o.textBaseline="alphabetic",o.x=CANVAS_WIDTH/2+20,o.y=250,o.outline=3,c.addChild(o),n=new createjs.Text(TEXT_CREDITS_DEVELOPED,"28px "+FONT_GAME,TEXT_COLOR),n.textAlign="center",n.textBaseline="alphabetic",n.x=CANVAS_WIDTH/2+20,n.y=o.y,c.addChild(n),u=s_oSpriteLibrary.getSprite("logo_ctl"),t=createBitmap(u),t.regX=u.width/2,t.regY=u.height/2,t.x=CANVAS_WIDTH/2+20,t.y=330,c.addChild(t),r=new createjs.Text("www.codethislab.com","32px "+FONT_GAME,"#000"),r.textAlign="center",r.textBaseline="alphabetic",r.x=CANVAS_WIDTH/2+20,r.y=435,r.outline=3,c.addChild(r),a=new createjs.Text("www.codethislab.com","32px "+FONT_GAME,TEXT_COLOR),a.textAlign="center",a.textBaseline="alphabetic",a.x=CANVAS_WIDTH/2+20,a.y=r.y,c.addChild(a),this.refreshButtonPos(s_iOffsetX,s_iOffsetY)},this.refreshButtonPos=function(e,t){},this.unload=function(){playSound("click",1,0),s.off("click",this._onLogoButRelease),i.unload(),i=null,s_oStage.removeChild(c)},this._onLogoButRelease=function(){playSound("click",1,0),window.open("http://www.codethislab.com/index.php?&l=en","_blank")},this._init()}function CPlatform(e,t,i,n,o){var s,a,r,l,c,h,_,u=null,d=!1;return this._init=function(e,t,i,n,o){s=o,_=i;var d=s_oSpriteLibrary.getSprite("floor_"+n);a=createBitmap(d),a.x=e,a.y=t,c=d.width+OFFSET_PLATFORM_COL_DIMENSION[n].x,h=d.height+OFFSET_PLATFORM_COL_DIMENSION[n].y,l={x:e+OFFSET_PLATFORM_COL_POINT[n].x,y:t+OFFSET_PLATFORM_COL_POINT[n].y,w:c,h:h},r=new createjs.Rectangle(l.x,l.y,l.w,l.h),SHOW_COLLISION_SHAPE&&(u=new createjs.Shape,u.graphics.beginFill("#00ff00").drawRect(r.x,r.y,r.width,r.height),u.alpha=.5,s.addChild(u)),s.addChild(a)},this.setPosition=function(e,t){a.x=e,a.y=t,this.rectMovement()},this.rectMovement=function(){l={x:a.x+OFFSET_PLATFORM_COL_POINT[n].x,y:a.y+OFFSET_PLATFORM_COL_POINT[n].y,w:c,h:h},r.setValues(l.x,l.y,l.w,l.h),SHOW_COLLISION_SHAPE&&(u&&(s.removeChild(u),u=null),u=new createjs.Shape,u.graphics.beginFill("#00ff00").drawRect(r.x,r.y,r.width,r.height),u.alpha=.5,s.addChild(u))},this.getX=function(){return a.x},this.getY=function(){return a.y},this.getRectX=function(){return r.x},this.getWidth=function(){return c},this.setVisible=function(e){a.visible=e},this.collideYet=function(){return d},this.setCollideYet=function(e){d=e},this.unload=function(){s.removeChild(a)},this.getID=function(){return _},this.setID=function(e){_=e},this.controlCollision=function(e){if(r){var t;return r.intersects(e)?e.x+.6*e.width>r.x&&r.y>=Math.floor(e.y)+OFFSET_HEIGHT_COLLISION_PLATFORM?(t={collision:COLLISION_PLATFORM,id:_,y:a.y,collide:d},d=!0):t={collision:COLLISION_WALL,id:_,y:a.y}:(d=!1,t={collision:COLLISION_NOTHING,id:_,y:a.y,collide:d}),t}},this._init(e,t,i,n,o),this}function CObject(e,t,i,n,o){var s,a,r,l,c,h,_,u,d,S=null,g=!1;return this._init=function(e,t,i,n,o){s=o,u=i,d=n;var g=s_oSpriteLibrary.getSprite("object_"+n),f=1,p=1;if(0===d){f=4,p=5;var E={images:[g],frames:{width:g.width/p,height:g.height/f,regX:0,regY:g.height/2/f},animations:{normal:[0,19,"normal"]}},O=new createjs.SpriteSheet(E);a=createSprite(O,"run",0,g.height/2/f,g.width/p,g.height/f)}else a=createBitmap(g),a.regX=0,a.regY=g.height/2;a.x=e,a.y=t,c=g.width/p,h=g.height/f,_=.5*h,l={x:e,y:t-_,w:c,h:h},r=new createjs.Rectangle(e,t,c,h),SHOW_COLLISION_SHAPE&&(S=new createjs.Shape,S.graphics.beginFill("#00ff00").drawRect(r.x,r.y,r.width,r.height),S.alpha=.5,s.addChild(S)),s.addChild(a)},this.setPosition=function(e,t){a.x=e,a.y=t,this.rectMovement()},this.rectMovement=function(){l={x:a.x,y:a.y-_,w:c,h:h},r.setValues(l.x,l.y,l.w,l.h),SHOW_COLLISION_SHAPE&&(S&&(s.removeChild(S),S=null),S=new createjs.Shape,S.graphics.beginFill("#00ff00").drawRect(r.x,r.y,r.width,r.height),S.alpha=.5,s.addChild(S))},this.getX=function(){return a.x},this.getY=function(){return a.y},this.getRectX=function(){return r.x},this.getWidth=function(){return c},this.setVisible=function(e){a.visible=e},this.collideYet=function(){return g},this.getVisible=function(){return a.visible},this.unload=function(){s.removeChild(a)},this.getID=function(){return u},this.setID=function(e){u=e},this.controlCollision=function(e){r&&r.intersects(e)&&(0===n?(s_oGame.addScore(COIN_SCORE),playSound("coin",1,0),s_oGame.addObtainCoin(),s_oGame.unloadObject(u)):1===n&&s_oGame.spikeCollision())},this._init(e,t,i,n,o),this}function CMenu(){var e,t,i,n,o,s,a,r,l,c;this._init=function(){o=createBitmap(s_oSpriteLibrary.getSprite("bg_menu")),s_oStage.addChild(o);var i=s_oSpriteLibrary.getSprite("but_play");if(t={x:CANVAS_WIDTH/2,y:CANVAS_HEIGHT-90},s=new CGfxButton(t.x,t.y,i,s_oStage),s.addEventListener(ON_MOUSE_UP,this._onButPlayRelease,this),s.pulseAnimation(),DISABLE_SOUND_MOBILE===!1||s_bMobile===!1){var i=s_oSpriteLibrary.getSprite("audio_icon");e={x:CANVAS_WIDTH-i.height/2-10,y:i.height/2+10},c=new CToggle(e.x,e.y,i,s_bAudioActive,s_oStage),c.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this)}var r=s_oSpriteLibrary.getSprite("but_info");n={x:r.height/2+10,y:r.height/2+10},a=new CGfxButton(n.x,n.y,r,s_oStage),a.addEventListener(ON_MOUSE_UP,this._onButInfoRelease,this),l=new createjs.Shape,l.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),s_oStage.addChild(l),createjs.Tween.get(l).to({alpha:0},800).call(function(){l.visible=!1}),this.refreshButtonPos(s_iOffsetX,s_iOffsetY)},this.refreshButtonPos=function(o,l){s.setPosition(t.x,t.y-l),r&&r.setPosition(i.x,i.y-l),a.setPosition(n.x+o,n.y+l),DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||c.setPosition(e.x-o,l+e.y)},this.unload=function(){s.unload(),s=null,DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||(c.unload(),c=null),s_oStage.removeAllChildren(),createjs.Tween.removeAllTweens(),s_oMenu=null},this._onAudioToggle=function(){createjs.Sound.setMute(s_bAudioActive),s_bAudioActive=!s_bAudioActive},this._onButInfoRelease=function(){new CCreditsPanel},this._onButPlayRelease=function(){this.unload(),playSound("click",1,0),s_oMain.gotoGame()},s_oMenu=this,this._init()}function CPause(){var e,t;return this._init=function(){var e=new createjs.Container;e.alpha=1,t=new createjs.Shape,t.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),t.alpha=.5;var i=new createjs.Shape;i.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),t.hitArea=i,t.on("click",function(){}),e.addChild(t);var n=new createjs.Text(TEXT_PAUSE,"50px "+FONT_GAME,"#000000");n.x=.5*CANVAS_WIDTH,n.y=.5*CANVAS_HEIGHT-130,n.textAlign="center",n.outline=5,e.addChild(n);var o=new createjs.Text(TEXT_PAUSE,"50px "+FONT_GAME,TEXT_COLOR);o.x=n.x,o.y=n.y,o.textAlign="center",e.addChild(o);var s,a=s_oSpriteLibrary.getSprite("but_continue");s=new CGfxButton(.5*CANVAS_WIDTH,.5*CANVAS_HEIGHT+70,a,e),s.addEventListenerWithParams(ON_MOUSE_UP,this._onLeavePause,this,e),s_oStage.addChild(e)},this.unload=function(){t.off("click",function(){}),s_oStage.removeChild(e)},this._onLeavePause=function(e){createjs.Ticker.paused=!1,createjs.Tween.get(e).to({alpha:0},300,createjs.quartIn).call(function(){s_oInterface.unloadPause(),s_oGame.unpause(!0)})},this._init(),this}function CToggle(e,t,i,n,o){var s,a,r,l,c;this._init=function(e,t,i,n){a=new Array,r=new Array;var o={images:[i],frames:{width:i.width/2,height:i.height,regX:i.width/2/2,regY:i.height/2},animations:{state_true:[0],state_false:[1]}},h=new createjs.SpriteSheet(o);s=n,l=createSprite(h,"state_"+s,i.width/2/2,i.height/2,i.width/2,i.height),l.x=e,l.y=t,l.stop(),s_bMobile||(l.cursor="pointer"),c.addChild(l),this._initListener()},this.unload=function(){l.off("mousedown",this.buttonDown),l.off("pressup",this.buttonRelease),c.removeChild(l)},this._initListener=function(){l.on("mousedown",this.buttonDown),l.on("pressup",this.buttonRelease)},this.addEventListener=function(e,t,i){a[e]=t,r[e]=i},this.setCursorType=function(e){l.cursor=e},this.setActive=function(e){s=e,l.gotoAndStop("state_"+s)},this.buttonRelease=function(){l.scaleX=1,l.scaleY=1,playSound("click",1,0),s=!s,l.gotoAndStop("state_"+s),a[ON_MOUSE_UP]&&a[ON_MOUSE_UP].call(r[ON_MOUSE_UP],s)},this.buttonDown=function(){l.scaleX=.9,l.scaleY=.9,a[ON_MOUSE_DOWN]&&a[ON_MOUSE_DOWN].call(r[ON_MOUSE_DOWN])},this.setPosition=function(e,t){l.x=e,l.y=t},c=o,this._init(e,t,i,n)}function CCoin(e,t,i,n,o,s){var a,r,l,c,h,_,u,d,S,g=null,f=!1;return this._init=function(e,t,i,n,o){a=o,d=n,S=i;var s=s_oSpriteLibrary.getSprite("object_"+i),f=2,p=7,E={images:[s],frames:{width:s.width/p,height:s.height/f,regX:0,regY:s.height/2/f},animations:{normal:[0,13,"normal",.5]}},O=new createjs.SpriteSheet(E);r=createSprite(O,"normal",0,s.height/2/f,s.width/p,s.height/f),r.stop(),r.x=e,r.y=t,h=s.width/p,_=s.height/f,u=.5*_,c={x:e,y:t-u,w:h,h:_},l=new createjs.Rectangle(e,t,h,_),SHOW_COLLISION_SHAPE&&(g=new createjs.Shape,g.graphics.beginFill("#00ff00").drawRect(l.x,l.y,l.width,l.height),g.alpha=.5,a.addChild(g)),a.addChild(r)},this.setPosition=function(e,t){r.x=e,r.y=t,this.rectMovement()},this.rectMovement=function(){var e=this.getPosLocal();c={x:e.x,y:e.y-u,w:h,h:_},l.setValues(c.x,c.y,c.w,c.h),SHOW_COLLISION_SHAPE&&(g&&(a.removeChild(g),g=null),g=new createjs.Shape,g.graphics.beginFill("#00ff00").drawRect(l.x,l.y,l.width,l.height),g.alpha=.5,a.addChild(g))},this.getX=function(){return r.x},this.getY=function(){return r.y},this.getPosLocal=function(){return a.localToGlobal(r.x,r.y)},this.getRectX=function(){return l.x},this.getWidth=function(){return h},this.setToken=function(e){f=e},this.setVisible=function(e){f||(r.visible===!1&&e===!0?r.play():r.visible===!0&&e===!1&&r.stop(),r.visible=e)},this.getVisible=function(){return r.visible},this.unload=function(){a.removeChild(r)},this.getID=function(){return d},this.setID=function(e){d=e},this.getType=function(){return S},this.controlCollision=function(e){if(l){var t=this;l.intersects(e.rect)&&(f||(s_oGame.addScore(COIN_SCORE),playSound("coin",1,0),s_oGame.addObtainCoin(),f=!0,r.visible=!1,s_oInterface.coinEffect(t.getPosLocal())))}},this.update=function(){},this._init(e,t,i,n,o),this}function CParallaxeBg(e,t,i,n){var o,s;return this._init=function(e,t,i,n){s=n,o=createBitmap(i),this.setPosition(e,t),s.addChild(o)},this.setPosition=function(e,t){o.x=e,o.y=t},this.getX=function(){return o.x},this.getY=function(){return o.y},this.getVisible=function(){return o.visible},this.setVisible=function(e){o.visible=e},this.unload=function(){s.removeChild(o),o=null},this._init(e,t,i,n),this}function CFlue(e,t,i,n,o){var s,a,r,l,c,h,_,u,d,S,g,f=null,p=!1;return this._init=function(e,t,i,n,o){s=o,S=n,g=i;var p=s_oSpriteLibrary.getSprite("object_"+i),E=2,O=5,A={images:[p],frames:{width:p.width/O,height:p.height/E,regX:0,regY:p.height/2/E},animations:{normal:[0,9,"reverse",.5],reverse:{frames:[8,7,6,5,4,3,2,1],next:"normal",speed:.5}}},T=new createjs.SpriteSheet(A);a=createSprite(T,"normal",0,p.height/2/E,p.width/O,p.height/E),a.stop(),_=p.width/O,u=p.height/E,a.x=e,a.y=t-u/8,d=.5*u,l={x:e+OFFSET_FLUE_COLLISION_DOWN.x,y:t+OFFSET_FLUE_COLLISION_DOWN.y,w:_+OFFSET_FLUE_COLLISION_DOWN.w,h:u+OFFSET_FLUE_COLLISION_DOWN.h},r=new createjs.Rectangle(l.x,l.y,l.w,l.h),h={x:e+OFFSET_FLUE_COLLISION_UP.x,y:t+OFFSET_FLUE_COLLISION_UP.y,w:_+OFFSET_FLUE_COLLISION_UP.w,h:u+OFFSET_FLUE_COLLISION_UP.h},c=new createjs.Rectangle(h.x,h.y,h.w,h.h),SHOW_COLLISION_SHAPE&&(f=new createjs.Shape,f.graphics.beginFill("#00ff00").drawRect(c.x,c.y,c.width,c.height),f.alpha=.5,s.addChild(f)),s.addChild(a)},this.setPosition=function(e,t){a.x=e,a.y=t,this.rectMovement()},this.rectMovement=function(){var e=this.getPosLocal();l={x:e.x+OFFSET_FLUE_COLLISION_DOWN.x,y:e.y+OFFSET_FLUE_COLLISION_DOWN.y,w:_+OFFSET_FLUE_COLLISION_DOWN.w,h:u+OFFSET_FLUE_COLLISION_DOWN.h},r.setValues(l.x,l.y,l.w,l.h),h={x:e.x+OFFSET_FLUE_COLLISION_UP.x,y:e.y+OFFSET_FLUE_COLLISION_UP.y,w:_+OFFSET_FLUE_COLLISION_UP.w,h:u+OFFSET_FLUE_COLLISION_UP.h},c=new createjs.Rectangle(h.x,h.y,h.w,h.h),SHOW_COLLISION_SHAPE&&(f&&(s.removeChild(f),f=null),f=new createjs.Shape,f.graphics.beginFill("#00ff00").drawRect(r.x,r.y,r.width,r.height),f.alpha=.5,s.addChild(f))},this.getX=function(){return a.x},this.getY=function(){return a.y},this.getRectX=function(){return r.x},this.getWidth=function(){return _},this.setVisible=function(e){a.visible===!1&&e===!0?a.play():a.visible===!0&&e===!1&&a.stop(),a.visible=e},this.getVisible=function(){return a.visible},this.getPosLocal=function(){return s.localToGlobal(a.x,a.y)},this.unload=function(){s.removeChild(a)},this.getID=function(){return S},this.setID=function(e){S=e},this.getType=function(){return g},this.controlCollision=function(e){r&&(r.intersects(e.rect)?s_oGame.characterDead():s_oGame.getState()===GAME_STATE_PLAY&&c.intersects(e.rect)?p||(p=!0,s_oGame.flueUp(p)):p&&(p=!1,s_oGame.flueUp(!1)))},this.update=function(){},this._init(e,t,i,n,o),this}function CCoinBoard(e,t){var i,n,o,s,a,r;return this._init=function(e,t){i={x:e,y:t},n=new createjs.Container,n.x=i.x,n.y=i.y,a=new createjs.Text("x 0","32px "+FONT_GAME,"#000"),a.x=30,a.textAlign="left",a.textBaseline="middle",a.outline=4,n.addChild(a),s=new createjs.Text("x 0","32px "+FONT_GAME,TEXT_COLOR),s.x=30,s.textAlign="left",s.textBaseline="middle",n.addChild(s),o=this.createCoin(-15,0,n,!0),s_oStage.addChild(n),r=new Array;for(var l=0;MAX_COIN_EFFECT_INSTANCE>l;l++)r.push(this.createCoin(-15,0,s_oStage,!1))},this.animCoinEffect=function(e){var t=0;for(t=0;t<r.length&&r[t].visible;t++);r[t].visible=!0,r[t].x=e.x,r[t].y=e.y,createjs.Tween.get(r[t]).to({x:o.x+n.x,y:o.y+n.y},MS_ANIM_COIN,createjs.Ease.cubicOut).call(function(){r[t].visible=!1})},this.getStartPosition=function(){return i},this.setPosition=function(e,t){n.x=e,n.y=t},this.createCoin=function(e,t,i,n){var o,s=s_oSpriteLibrary.getSprite("coin");return o=createBitmap(s),o.x=e,o.y=t,o.regX=.5*s.width,o.regY=.5*s.height,o.visible=n,i.addChild(o),o},this.getPos=function(){return{x:n.x,y:n.y}},this.unload=function(){s_oStage.removeChild(n)},this.refresh=function(e){s.text=e,a.text=e},this._init(e,t),this}function CCharacter(e,t,i,n){var o,s,a,r,l,c,h,_,u,d,S,g,f=null,p=!1,E=!1,O=!1,A=!1;this._init=function(e,t,i,n){s=n;var p={images:[i],frames:{width:i.width/5,height:i.height/8,regX:i.width/2/5,regY:i.height/8},animations:{run:[0,14,"run",1],fly_die:[24,30,"fly_die_stay",1],fly_die_stay:30,die:[31,37,"die_stay"],die_stay:37,fly:[15,23,"fly"]}},E=new createjs.SpriteSheet(p);o=createSprite(E,"run",i.width/2/5,i.height/8,i.width/5,i.height/8),o.x=e,o.y=t,c=HERO_DOWN_ACCELLERATION,u=i.width/5,d=i.height/8,S=CHARECTER_LIMIT_Y+.5*d,g={x:e-u+OFFSET_PLAYER_COL_POINT.x,y:t-d+OFFSET_PLAYER_COL_POINT.y,w:u+OFFSET_PLAYER_COL_DIMENSION.x,h:d+OFFSET_PLAYER_COL_DIMENSION.y},a=new createjs.Rectangle(g.x,g.y,g.w,g.h),SHOW_COLLISION_SHAPE&&(f=new createjs.Shape,f.graphics.beginFill("#00ff00").drawRect(a.x,a.y,a.width,a.height),f.alpha=.5,s.addChild(f)),h=0,_=0,r=playSound("step",1,-1),l=playSound("jet",.3,-1),this.stopStepSound(),this.stopJetSound(),s.addChild(o)},this.getX=function(){return o.x},this.getY=function(){return o.y},this.onPlatform=function(e){E=e},this.setScale=function(e){o.scaleX=o.scaleY=e},this.getOnPlatform=function(){return E},this.setFlue=function(e){A=e},this.animationStartGame=function(){var e=this;o.gotoAndPlay("start_0"),o.on("animationend",function(){o.removeAllEventListeners(),o.gotoAndPlay("start_1"),e.stayMouseDown(!0),h=-HERO_DOWN_ACCELLERATION*JUMP_MULTIPLY*.5,c=-HERO_DOWN_ACCELLERATION,p=!1,s_oGame.increasePlatformSpeedAnim(!0),o.on("animationend",function(){o.removeAllEventListeners(),o.gotoAndPlay("fly"),e.stayMouseDown(!1),s_oGame.increasePlatformSpeedAnim(!1),s_oGame.startAfterAnim()})})},this.setPosition=function(e,t){null===e||(o.x=e),null===t||(o.y=t),this.rectMovement()},this.playSoundStep=function(){playExistingSound(r)},this.stopStepSound=function(){stopSound(r)},this.playSoundJet=function(){playExistingSound(l)},this.stopJetSound=function(){stopSound(l)},this.rotate=function(e){o.scaleX=e},this.setVisible=function(e){o.visible=e},this.changeState=function(e){o.gotoAndPlay(e)},this.stopAnimation=function(){o.stop()},this.playAnimation=function(){o.play()},this.onFinishAnimation=function(e){o.on("animationend",function(){e()})},this.collisionWithPlatform=function(e){p===!0&&o.gotoAndPlay("jump"),p=e},this.getCollisionWithPlatform=function(){return p},this.getRectangle=function(){return a},this.moveUp=function(e){h=-HERO_DOWN_ACCELLERATION*e,c=-HERO_DOWN_ACCELLERATION},this.stayMouseDown=function(e){O=e},this.unload=function(){s.removeChild(o),destroySound(r),destroySound(l),s_oCharacter=null},this.playerIDPlatform=function(e){_=e},this.getIDPlatform=function(){return _},this.resetJump=function(){c=HERO_DOWN_ACCELLERATION},this.rectMovement=function(){g={x:o.x-u+OFFSET_PLAYER_COL_POINT.x,y:o.y-d+OFFSET_PLAYER_COL_POINT.y,w:u+OFFSET_PLAYER_COL_DIMENSION.x,h:d+OFFSET_PLAYER_COL_DIMENSION.y},a.setValues(g.x,g.y,g.w,g.h),SHOW_COLLISION_SHAPE&&(f&&(s.removeChild(f),f=null),f=new createjs.Shape,f.graphics.beginFill("#00ff00").drawRect(a.x,a.y,a.width,a.height),f.alpha=.5,s.addChild(f))},this.removeTweens=function(){createjs.Tween.removeTweens(o)},this.update=function(){O||A?c>MAX_DECELLERATION_VEL?c+=DECELLERATION_MOUSE_DOWN:c=MAX_DECELLERATION_VEL:c<HERO_DOWN_ACCELLERATION?c+=DECELLERATION_NORMAL:c=HERO_DOWN_ACCELLERATION,p?h=0:(h+=c,o.y+=h),o.y<S&&(o.y=S,h=0),this.rectMovement()},s_oCharacter=this,this._init(e,t,i,n)}function CSpriteLibrary(){var e,t,i,n,o,s;this.init=function(a,r,l){t=0,i=0,n=a,o=r,s=l,e={}},this.addSprite=function(i,n){e.hasOwnProperty(i)||(e[i]={szPath:n,oSprite:new Image},t++)},this.getSprite=function(t){return e.hasOwnProperty(t)?e[t].oSprite:null},this._onSpritesLoaded=function(){o.call(s)},this._onSpriteLoaded=function(){n.call(s),++i==t&&this._onSpritesLoaded()},this.loadSprites=function(){for(var t in e)e[t].oSprite.oSpriteLibrary=this,e[t].oSprite.onload=function(){this.oSpriteLibrary._onSpriteLoaded()},e[t].oSprite.src=e[t].szPath},this.getNumSprites=function(){return t}}function CMain(e){var t,i,n,o,s,a,r=0,l=0,c=STATE_LOADING;this.initContainer=function(){var e=document.getElementById("canvas");s_oStage=new createjs.Stage(e),createjs.Touch.enable(s_oStage),s_oStage.preventSelection=!1,e.opacity=.5,s_bMobile=jQuery.browser.mobile,s_bMobile===!1&&(s_oStage.enableMouseOver(20),$("body").on("contextmenu","#canvas",function(e){return!1})),s_iPrevTime=(new Date).getTime(),createjs.Ticker.addEventListener("tick",this._update),createjs.Ticker.setFPS(30),navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0),s_oSpriteLibrary=new CSpriteLibrary,n=new CPreloader,t=!0},this.soundLoaded=function(){r++;var e=Math.floor(r/l*100);n.refreshLoader(e),r===l&&(n.unload(),DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||(s_oSoundTrack=createjs.Sound.play("soundtrack",{loop:-1})),this.gotoMenu())},this._initSounds=function(){createjs.Sound.initializeDefaultPlugins()&&(navigator.userAgent.indexOf("Opera")>0||navigator.userAgent.indexOf("OPR")>0?(createjs.Sound.alternateExtensions=["mp3"],createjs.Sound.addEventListener("fileload",createjs.proxy(this.soundLoaded,this)),createjs.Sound.registerSound("./sounds/click.ogg","click"),createjs.Sound.registerSound("./sounds/soundtrack.ogg","soundtrack"),createjs.Sound.registerSound("./sounds/coin.ogg","coin"),createjs.Sound.registerSound("./sounds/step.ogg","step"),createjs.Sound.registerSound("./sounds/jet.ogg","jet"),createjs.Sound.registerSound("./sounds/die.ogg","die")):(createjs.Sound.alternateExtensions=["ogg"],createjs.Sound.addEventListener("fileload",createjs.proxy(this.soundLoaded,this)),createjs.Sound.registerSound("./sounds/click.mp3","click"),createjs.Sound.registerSound("./sounds/soundtrack.mp3","soundtrack"),createjs.Sound.registerSound("./sounds/coin.mp3","coin"),createjs.Sound.registerSound("./sounds/step.mp3","step"),createjs.Sound.registerSound("./sounds/jet.mp3","jet"),createjs.Sound.registerSound("./sounds/die.mp3","die")),l+=6)},this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this),s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png"),s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png"),s_oSpriteLibrary.addSprite("but_info","./sprites/but_info.png"),s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.png"),s_oSpriteLibrary.addSprite("but_exit_big","./sprites/but_exit_big.png"),s_oSpriteLibrary.addSprite("but_continue","./sprites/but_continue.png"),s_oSpriteLibrary.addSprite("but_pause","./sprites/but_pause.png"),s_oSpriteLibrary.addSprite("but_yes","./sprites/but_yes.png"),s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg"),s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.png"),s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png"),s_oSpriteLibrary.addSprite("but_home","./sprites/but_home.png"),s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.png"),s_oSpriteLibrary.addSprite("player","./sprites/player.png"),s_oSpriteLibrary.addSprite("logo_ctl","./sprites/logo_ctl.png"),s_oSpriteLibrary.addSprite("end_panel","./sprites/end_panel.png"),s_oSpriteLibrary.addSprite("help_mouse","./sprites/help_mouse.png"),s_oSpriteLibrary.addSprite("help_touch","./sprites/help_touch.png"),s_oSpriteLibrary.addSprite("object_0","./sprites/object_0.png"),s_oSpriteLibrary.addSprite("object_1","./sprites/object_1.png"),s_oSpriteLibrary.addSprite("floor_0","./sprites/floor_0.png"),s_oSpriteLibrary.addSprite("coin","./sprites/coin.png");for(var e=0;BG_TYPES>e;e++)s_oSpriteLibrary.addSprite("bg_"+e,"./sprites/bg/bg_"+e+".jpg");for(var e=0;e<GID_OBJECTS.length;e++)s_oSpriteLibrary.addSprite("object_"+e,"./sprites/object_"+e+".png");l+=s_oSpriteLibrary.getNumSprites(),s_oSpriteLibrary.loadSprites()},this._onImagesLoaded=function(){r++;var e=Math.floor(r/l*100);n.refreshLoader(e),r===l&&(n.unload(),DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||(s_oSoundTrack=createjs.Sound.play("soundtrack",{loop:-1})),this.gotoMenu())},this._onAllImagesLoaded=function(){},this.onAllPreloaderImagesLoaded=function(){this._loadImages()},this.preloaderReady=function(){DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||(this._initSounds(),s_oSoundTrack=createjs.Sound.play("soundtrack",{loop:-1})),this.loadJSON(),this._loadImages(),t=!0},this.onLoadedJSON=function(e){s_aLevelDiagram=e},this.loadJSON=function(){jQuery.getJSON(URL_LEVELS_SETTINGS,this.onLoadedJSON)},this.gotoMenu=function(){o=new CMenu,c=STATE_MENU},this.gotoGame=function(e){a=new CGame(i,e),c=STATE_GAME,$(s_oMain).trigger("start_session")},this.gotoHelp=function(){s=new CHelp,c=STATE_HELP},this.stopUpdate=function(){t=!1,createjs.Ticker.paused=!0,$("#block_game").css("display","block")},this.startUpdate=function(){s_iPrevTime=(new Date).getTime(),t=!0,createjs.Ticker.paused=!1,$("#block_game").css("display","none")},this._update=function(e){if(t!==!1){var i=(new Date).getTime();s_iTimeElaps=i-s_iPrevTime,s_iCntTime+=s_iTimeElaps,s_iCntFps++,s_iPrevTime=i,s_iCntTime>=1e3&&(s_iCurFps=s_iCntFps,s_iCntTime-=1e3,s_iCntFps=0),c===STATE_GAME&&a.update(),s_oStage.update(e)}},s_oMain=this,i=e,this.initContainer()}function CCogWheel(e,t,i,n,o,s){var a,r,l,c,h,_,u,d=o;return this._init=function(e,t,i,n,o){a=o,h=n,_=i;var s=s_oSpriteLibrary.getSprite("object_"+i);r=createBitmap(s),l=.5*s.width,c=.5*s.height,r.x=e+l,r.y=t-c,r.regY=c,r.regX=l,a.addChild(r)},this.setPosition=function(e,t){r.x=e,r.y=t},this.getX=function(){return r.x},this.getY=function(){return r.y},this.getType=function(){return _},this.getWidth=function(){return r.regX},this.setVisible=function(e){r.visible=e},this.getVisible=function(){return r.visible},this.unload=function(){a.removeChild(r)},this.getPosLocal=function(){return u=a.localToGlobal(r.x,r.y)},this.getID=function(){return h},this.setID=function(e){h=e},this.controlCollision=function(e){var t={x:u.x,y:u.y+80},i=distanceSQRT(e.pos,t);i<=l+e.rect.height*COG_COLLISION_FACTOR&&s_oGame.characterDead()},this.update=function(){r.rotation+=d},this._init(e,t,i,n,s),this}function CTextButton(e,t,i,n,o,s,a,r){var l,c,h,_;return this._init=function(e,t,i,n,o,s,a){l=new Array,c=new Array;var r=createBitmap(i),u=Math.ceil(a/20),d=new createjs.Text(n,"bold "+a+"px "+o,"#000000");d.textAlign="center",d.textBaseline="alphabetic";var S=d.getBounds();d.x=i.width/2+u,d.y=Math.floor(i.height/2)+S.height/3+u;var g=new createjs.Text(n,"bold "+a+"px "+o,s);g.textAlign="center",g.textBaseline="alphabetic";var S=g.getBounds();g.x=i.width/2,g.y=Math.floor(i.height/2)+S.height/3,h=new createjs.Container,h.x=e,h.y=t,h.regX=i.width/2,h.regY=i.height/2,h.addChild(r,d,g),s_bMobile||(h.cursor="pointer"),_.addChild(h),this._initListener()},this.unload=function(){h.off("mousedown"),h.off("pressup"),_.removeChild(h)},this.setVisible=function(e){h.visible=e},this._initListener=function(){oParent=this,h.on("mousedown",this.buttonDown),h.on("pressup",this.buttonRelease)},this.addEventListener=function(e,t,i){l[e]=t,c[e]=i},this.buttonRelease=function(){h.scaleX=1,h.scaleY=1,playSound("click",1,0),l[ON_MOUSE_UP]&&l[ON_MOUSE_UP].call(c[ON_MOUSE_UP])},this.buttonDown=function(){h.scaleX=.9,h.scaleY=.9,l[ON_MOUSE_DOWN]&&l[ON_MOUSE_DOWN].call(c[ON_MOUSE_DOWN])},this.setPosition=function(e,t){h.x=e,h.y=t},this.setX=function(e){h.x=e},this.setY=function(e){h.y=e},this.getButtonImage=function(){return h},this.getX=function(){return h.x},this.getY=function(){return h.y},_=r,this._init(e,t,i,n,o,s,a),this}function CParallaxBg(e,t,i){var n,o,s,a,r=0;return this._init=function(e,t,i){s=new Array,n=i,o=new createjs.Container,o.x=e,o.y=t,n.addChild(o),n.setChildIndex(o,1);var r=s_oSpriteLibrary.getSprite("bg_0");a=r.width,this.addBg()},this.addBg=function(){for(var e=0,t=0,i=0;BG_TYPES>i;i++){var n=s_oSpriteLibrary.getSprite("bg_"+i);s[i]=new CParallaxeBg(e,t,n,o),e>CANVAS_WIDTH+a&&s[i].setVisible(!1),e+=a}},this.unload=function(){n.removeChild(o),o=null},this.unloadObject=function(){for(var e=0;e<s.length;e++)o.removeChild(s[e])},this.setSpeed=function(e){r=e},this.update=function(){for(var e=0;NUM_PARALLAX_BG>e;e++){var t=s[e].getX()+r,i=s[e].getY();if(s[e].setPosition(t,i),s[e].getX()<-a){var n=e+NUM_PARALLAX_BG-1,o=s.shift();o.setVisible(!1),s.push(o),s[n].setVisible(!0),s[n].setPosition(s[n-1].getX()+a,s[n-1].getY()),s[e].setPosition(s[e].getX()+r,i)}}},this._init(e,t,i),this}function CPreloader(){var e,t,i,n,o,s,a;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this),s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg"),s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png"),s_oSpriteLibrary.loadSprites(),a=new createjs.Container,s_oStage.addChild(a)},this.unload=function(){a.removeAllChildren()},this.hide=function(){var e=this;setTimeout(function(){createjs.Tween.get(s).to({alpha:1},500).call(function(){e.unload(),s_oMain.gotoMenu()})},1e3)},this._onImagesLoaded=function(){},this._onAllImagesLoaded=function(){this.attachSprites(),s_oMain.preloaderReady()},this.attachSprites=function(){var r=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));a.addChild(r);var l=s_oSpriteLibrary.getSprite("progress_bar");n=createBitmap(l),n.x=CANVAS_WIDTH/2-l.width/2,n.y=CANVAS_HEIGHT-200,a.addChild(n),e=l.width,t=l.height,o=new createjs.Shape,o.graphics.beginFill("rgba(255,255,255,0.01)").drawRect(n.x,n.y,1,t),a.addChild(o),n.mask=o,i=new createjs.Text("","30px "+FONT_GAME,TEXT_COLOR),i.x=CANVAS_WIDTH/2,i.y=CANVAS_HEIGHT-200,i.shadow=new createjs.Shadow("#000",2,2,2),i.textBaseline="alphabetic",i.textAlign="center",a.addChild(i),s=new createjs.Shape,s.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),s.alpha=0,a.addChild(s)},this.refreshLoader=function(s){i.text=s+"%",o.graphics.clear();var a=Math.floor(s*e/100);o.graphics.beginFill("rgba(255,255,255,0.01)").drawRect(n.x,n.y,a,t)},this._init()}function CRollingScore(){var e=null,t=null;return this.rolling=function(i,n,o){e=createjs.Tween.get(i,{override:!0}).to({text:o},MS_ROLLING_SCORE,createjs.Ease.cubicOut).addEventListener("change",function(){i.text=Math.floor(i.text)}).call(function(){createjs.Tween.removeTweens(e)}),null!==n&&(t=createjs.Tween.get(n,{override:!0}).to({text:o},MS_ROLLING_SCORE,createjs.Ease.cubicOut).addEventListener("change",function(){n.text=Math.floor(n.text)}).call(function(){createjs.Tween.removeTweens(t)}))},this}function CGfxButton(e,t,i,n){var o,s,a,r,l,c,h,_,u,d=!1;return this._init=function(e,t,i){o=new Array,s=new Array,a=createBitmap(i),a.x=e,a.y=t,l=1,c=1,a.regX=i.width/2,a.regY=i.height/2,s_bMobile||(a.cursor="pointer"),u.addChild(a),this._initListener()},this.unload=function(){a.off("mousedown",this.buttonDown),a.off("pressup",this.buttonRelease),u.removeChild(a)},this.setVisible=function(e){a.visible=e},this.setCursorType=function(e){a.cursor=e},this._initListener=function(){a.on("mousedown",this.buttonDown),a.on("pressup",this.buttonRelease)},this.addEventListener=function(e,t,i){o[e]=t,s[e]=i},this.addEventListenerWithParams=function(e,t,i,n){o[e]=t,s[e]=i,r=n},this.buttonRelease=function(){d||(l>0?a.scaleX=1:a.scaleX=-1,a.scaleY=1,playSound("click",1,0),o[ON_MOUSE_UP]&&o[ON_MOUSE_UP].call(s[ON_MOUSE_UP],r))},this.buttonDown=function(){d||(l>0?a.scaleX=.9:a.scaleX=-.9,a.scaleY=.9,o[ON_MOUSE_DOWN]&&o[ON_MOUSE_DOWN].call(s[ON_MOUSE_DOWN],r))},this.rotation=function(e){a.rotation=e},this.getButton=function(){return a},this.setPosition=function(e,t){a.x=e,a.y=t},this.setX=function(e){a.x=e},this.setY=function(e){a.y=e},this.getButtonImage=function(){return a},this.block=function(e){d=e,a.scaleX=l,a.scaleY=c},this.setScaleX=function(e){a.scaleX=e,l=e},this.getX=function(){return a.x},this.getY=function(){return a.y},this.pulseAnimation=function(){_=createjs.Tween.get(a).to({scaleX:.9*l,scaleY:.9*c},850,createjs.Ease.quadOut).to({scaleX:l,scaleY:c},650,createjs.Ease.quadIn).call(function(){h.pulseAnimation()})},this.trebleAnimation=function(){_=createjs.Tween.get(a).to({rotation:5},75,createjs.Ease.quadOut).to({rotation:-5},140,createjs.Ease.quadIn).to({rotation:0},75,createjs.Ease.quadIn).wait(750).call(function(){h.trebleAnimation()})},this.removeAllTweens=function(){createjs.Tween.removeTweens(a)},u=n,this._init(e,t,i),h=this,this}function CGame(e){var t,i,n,o,s,a,r,l,c,h,_,u,d=null,S=null,g=!1,f=!1;this._init=function(){t=!1,i=0,s=0,o=0,n=GAME_STATE_HELP,this.createLevel();var e=s_oSpriteLibrary.getSprite("player");this._createPlayer(e,CHARACTER_POSITION.x,CHARACTER_POSITION.y,s_oStage),_=new createjs.Shape,_.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),_.alpha=.01,s_oStage.addChild(_),a=new CInterface,a.refreshScore(i),n=GAME_STATE_HELP,this.activeListeners(),setVolume(s_oSoundTrack,.35)},this.activeListeners=function(){null===d&&(d=_.on("mousedown",this._onMouseDown),S=_.on("pressup",this._onPressUp))},this.deactiveListeners=function(){_.off("mousedown",d),_.off("pressup",S),d=null,S=null},this.createParallaxBg=function(){h=new CParallaxBg(0,0,s_oStage),h.setSpeed(PARALLAX_SPEED)},this._createPlayer=function(e,t,i,n){r=new CCharacter(t,i,e,n),r.stopAnimation()},this.createLevel=function(){this.createParallaxBg(),l=new CLevelSection(0,0,s_oStage),l.createSections(s_aLevelDiagram)},this._onMouseDown=function(){t&&n===GAME_STATE_PLAY&&(r.getCollisionWithPlatform()&&(r.stopStepSound(),r.changeState("fly"),r.playSoundJet()),
r.moveUp(JUMP_MULTIPLY),r.stayMouseDown(!0),r.collisionWithPlatform(!1))},this.characterDead=function(){n===GAME_STATE_PLAY&&(r.stayMouseDown(!1),n=GAME_STATE_GAMEOVER,l.setSpeed(0),h.setSpeed(0),playSound("die",.4,0),r.getCollisionWithPlatform()?(r.changeState("die"),r.stopStepSound(),createjs.Tween.get(this).wait(250).call(function(){this.gameOver()})):r.changeState("fly_die"))},this._onPressUp=function(){t&&n===GAME_STATE_PLAY&&r.stayMouseDown(!1)},this.unload=function(){t=!1,a.unload(),r.unload(),this.deactiveListeners(),s_oStage.removeAllChildren(),createjs.Tween.removeAllTweens()},this.onExit=function(){this.unload(),$(s_oMain).trigger("end_level",1),$(s_oMain).trigger("show_interlevel_ad"),$(s_oMain).trigger("end_session"),setVolume(s_oSoundTrack,1),s_oMain.gotoMenu()},this._onExitHelp=function(){$(s_oMain).trigger("start_level",1),t=!0,a.unloadHelpPanel(),r.playAnimation(),s_oGame.startAfterAnim()},this.startAfterAnim=function(){n=GAME_STATE_PLAY,l.setSpeed(PLATFORM_SPEED),h.setSpeed(PARALLAX_SPEED)},this.unpause=function(e){t=e,e===!0?(r.getCollisionWithPlatform()?r.playSoundStep():r.playSoundJet(),r.playAnimation()):(r.stopAnimation(),r.stopJetSound(),r.stopStepSound())},this.getScore=function(){return i},this.getState=function(){return n},this.changeState=function(e){n=e},this.gameOver=function(){n=GAME_STATE_FINISH,t=!1;var e=null!==getItem("bionic_best_score")?getItem("bionic_best_score"):0;a.createEndPanel(i,e),(i>getItem("bionic_best_score")||null===getItem("bionic_best_score"))&&saveItem("bionic_best_score",i),$(s_oMain).trigger("end_level",1)},this.addScore=function(e){i+=e,a.refreshScore(i)},this.restartLevel=function(){r.removeTweens(),l.reset(),i=0,s=0,a.refreshScore(i),a.refreshCoin(s),r.setPosition(CHARACTER_POSITION.x,CHARACTER_POSITION.y),r.playerIDPlatform(0),this.startAfterAnim(),r.resetJump(),r.changeState("run"),r.playSoundStep(),setVolume(s_oSoundTrack,.35),t=!0,$(s_oMain).trigger("restart_level",1)},this.unloadLevel=function(){l.unload(),l=null,h.unload(),h=null},this.collisionPlatform=function(e){e.collide===!1&&r.getCollisionWithPlatform()===!1&&(r.collisionWithPlatform(!0),r.setPosition(r.getX(),e.y+OFFSET_HEIGHT_PLATFORM_CHRACTER),n===GAME_STATE_PLAY?(r.changeState("run"),r.playSoundStep(),r.stopJetSound()):n===GAME_STATE_GAMEOVER&&(r.changeState("die"),r.stopJetSound(),r.stopStepSound(),createjs.Tween.get(this).wait(250).call(function(){this.gameOver()})))},this.flueUp=function(e){e&&r.moveUp(FLUE_POWER),r.setFlue(e)},this.unloadObject=function(e){c.unloadObject(e)},this.addObtainCoin=function(){s++,a.refreshCoin(s)},this.checkCollisionPlatform=function(e){e.collision===COLLISION_PLATFORM?this.collisionPlatform(e):e.collision===COLLISION_WALL?this.collisionWall():e.collision===COLLISION_NOTHING&&(r.collisionWithPlatform(!1),l.getPlatformByID(e.id).setCollideYet(!1))},this.increasePlatformSpeedAnim=function(e){u=SPEED_ANIMATION,f=e},this.update=function(){switch(n){case GAME_STATE_HELP:break;case GAME_STATE_PLAY:if(t){r.update();var e={rect:r.getRectangle(),id:r.getIDPlatform(),pos:{x:r.getX(),y:r.getY()}},i=l.update(e);r.playerIDPlatform(i.id),this.checkCollisionPlatform(i),h.update()}break;case GAME_STATE_FINISH:if(t&&!g&&r.getCollisionWithPlatform()===!1){var e={rect:r.getRectangle(),id:r.getIDPlatform(),pos:{x:r.getX(),y:r.getY()}},i=l.update(e);r.playerIDPlatform(i.id),i.collision===COLLISION_PLATFORM&&this.collisionPlatform(i),r.update()}break;case GAME_STATE_GAMEOVER:var e={rect:r.getRectangle(),id:r.getIDPlatform(),pos:{x:r.getX(),y:r.getY()}},i=l.update(e);r.playerIDPlatform(i.id),i.collision===COLLISION_PLATFORM&&this.collisionPlatform(i),r.update();break;case GAME_STATE_ANIMATION:if(t){r.update();var e={rect:r.getRectangle(),id:r.getIDPlatform()},i=l.update(e);r.playerIDPlatform(i.id),i.collision===COLLISION_PLATFORM&&this.collisionPlatform(i),f&&(u+=PLATFORM_SPEED_INCREASE,l.setSpeed(u))}}},s_oGame=this,PLATFORM_SPEED=e.platform_velocity,SCORE_DIFFICULTY=e.score_difficulty,HERO_DOWN_ACCELLERATION=e.hero_down_speed,MAX_DECELLERATION_VEL=e.max_decelleration_vel,DECELLERATION_MOUSE_DOWN=e.decelleration_mouse_down,DECELLERATION_NORMAL=e.decelleration_normal,NUM_LEVEL_FOR_ADS=e.num_levels_for_ads,JUMP_MULTIPLY=e.jump_multiplier,PARALLAX_SPEED=e.parallax_speed,COIN_SCORE=e.coin_score,PERCENTAGE_STARS=e.percentage_stars,this._init()}function CSection(e,t,i,n){var o,s,a,r,l,c=i,h=!1;return this._init=function(e,t,i){s=new createjs.Container,o=i,this.setPosition(e,t),a=new Array,r=new Array,o.addChild(s)},this.addObjects=function(e){for(var t=0;t<e.length;t++){switch(e[t].gid){case GID_OBJECTS[0]:a.push(new CCoin(e[t].x,e[t].y+50,e[t].gid,t,s,this));break;case GID_OBJECTS[1]:case GID_OBJECTS[2]:case GID_OBJECTS[3]:case GID_OBJECTS[4]:case GID_OBJECTS[5]:case GID_OBJECTS[6]:case GID_OBJECTS[7]:a.push(new CCogWheel(e[t].x,e[t].y+60,e[t].gid,t,e[t].vel_rotation,s));break;case GID_OBJECTS[8]:a.push(new CFlue(e[t].x,e[t].y,e[t].gid,t,s))}var i=a[t].getPosLocal(),n=i.x+a[t].getWidth();this.checkObjectVisibility(a[t],n,i.x)}},this.addPlatform=function(e){for(var t=e.length,i=e[0].length,n=FIRST_PLATFORM_X,o=PLATFORM_Y_START,a=0,l=0;i>l;l++){o=PLATFORM_Y_START;for(var c=0;t>c;c++)o+=80,-1!==e[c][l]&&(r[a]=new CPlatform(n,o,a,e[c][l],s),a++);n+=80}},this.setID=function(e){l=e},this.getID=function(){return l},this.isUsed=function(){return h},this.getStartID=function(){return c},this.setUsed=function(e){h=e},this.setPosition=function(e,t){s.x=e,s.y=t},this.getX=function(){return s.x},this.getY=function(){return s.y},this.setVisible=function(e){s.visible=e},this.unload=function(){o.removeChild(s)},this.getPlatformByID=function(e){return r[e]},this.collisionPlatforms=function(e){var t=e.id,i=e.rect,n=r[t].controlCollision(i);if(n.collision===COLLISION_NOTHING)for(var o=e.id+1;o<e.id+PREVIEW_COLLISION;o++)if(o>r.length-1);else{var s=r[o].controlCollision(i);if(s.collision===COLLISION_PLATFORM||s.collision===COLLISION_WALL)return s.collide=n.collide,s}return n},this.checkObjectVisibility=function(e,t,i){var n=i-e.getWidth();CANVAS_WIDTH>n&&t>0?e.setVisible(!0):e.setVisible(!1)},this.manageObject=function(e){for(var t=0;t<a.length;t++){a[t].setPosition(a[t].getX(),a[t].getY());var i=a[t].getPosLocal(),n=i.x+a[t].getWidth();this.checkObjectVisibility(a[t],n,i.x),n>0&&a[t].getVisible()&&(a[t].update(),a[t].controlCollision(e))}},this.resetCoinVisibility=function(){for(var e=0;e<a.length;e++)a[e].getType()===GID_OBJECTS[0]&&a[e].setToken(!1)},this.managePlatform=function(){for(var e=0;e<r.length;e++)r[e].setPosition(r[e].getX(),r[e].getY())},this.update=function(e,t){s.x+=e,this.managePlatform(),this.manageObject(t)},this._init(e,t,n),this}function CLevelSection(e,t,i){var n,o,s,a,r,l,c,h,_;return this._init=function(e,t,i){o=i,s=new Array,a=new Array,r=new Array,l=new Array,c=new Array,n=new createjs.Container,n.x=e,n.y=t,o.addChild(n),o.setChildIndex(n,2)},this.createSections=function(e){for(var t=0,i=0;i<e.length;i++){var o=new CSection(t,0,e[i].section,n);switch(o.addPlatform(e[i].platform),o.addObjects(e[i].objects),o.setID(i),c.push(o),e[i].difficulty){case EASY:a.push(o);break;case MEDIUM:r.push(o);break;case HARD:l.push(o)}t+=CANVAS_WIDTH}this.chooseRandomSection(0,a[0])},this.setSpeed=function(e){_=e},this.chooseRandomSection=function(e,t){this.resetAllSection(),h=new Array;var i;e>=SCORE_DIFFICULTY[4]?i=this.createShuffleIDArray(l):e>=SCORE_DIFFICULTY[3]?i=this.createShuffleIDArray(l.concat(r)):e>=SCORE_DIFFICULTY[2]?i=this.createShuffleIDArray(r):e>=SCORE_DIFFICULTY[1]?i=this.createShuffleIDArray(a.concat(r)):(e<SCORE_DIFFICULTY[0]||e<SCORE_DIFFICULTY[1])&&(i=this.createShuffleIDArray(a));for(var n=0;n<i.length;n++)h.push(c[i[n]]);for(var o=!1,n=0;n<h.length;n++)if(t.getID()===h[n].getID()){var s=h[0];h[0]=t,h[n]=s,o=!0}o===!1&&h.unshift(t);var _=CANVAS_WIDTH;h[0].setID(h.length-1);for(var n=1;n<h.length;n++)h[n].setID(n-1),h[n].resetCoinVisibility(),h[n].setPosition(h[0].getX()+_,h[n].getY()),h[n].getX()>CANVAS_WIDTH?h[n].setVisible(!1):h[n].setVisible(!0),_+=CANVAS_WIDTH},this.resetAllSection=function(){for(var e=0;e<c.length;e++)c[e].setID(e)},this.createShuffleIDArray=function(e){for(var t=new Array,i=0;i<e.length;i++)t.push(e[i].getID());return shuffle(t)},this.reset=function(){this.disableChoosenSection(),this.resetAllSection(),a[0].setPosition(0,a[0].getY()),a[0].setVisible(!0),this.chooseRandomSection(0,a[0])},this.disableChoosenSection=function(){for(var e=0;e<h.length;e++)h[e].setVisible(!1)},this.setSpeed=function(e){_=e},this.setPosition=function(e,t){n.x=e,n.y=t},this.unload=function(){o.removeChild(n),n=null,s=null},this.getPlatformByID=function(e){return h[0].getPlatformByID(e)},this.manageSections=function(e){for(var t=0;2>t;t++)if(h[t].update(_,e),h[t].getX()<-CANVAS_WIDTH){var i=h.shift();i.setVisible(!1),i.setPosition(CANVAS_WIDTH,i.getY()),h.push(i),h[t].update(_,e),h[t+1].setVisible(!0),h[t+1].setPosition(h[t].getX()+CANVAS_WIDTH,h[t].getY()),h[1].getID()===h.length-1&&this.randomizeSection(e)}},this.randomizeSection=function(e){this.chooseRandomSection(s_oGame.getScore(),h[0]),h[0].update(_,e),h[1].setPosition(h[0].getX()+CANVAS_WIDTH,h[1].getY()),h[1].setVisible(!0)},this.update=function(e){return this.manageSections(e),h[0].collisionPlatforms(e)},this._init(e,t,i),this}function CInterface(){var e,t,i,n,o,s,a,r,l,c,h,_,u,d,S,g,f,p=null;return this._init=function(){var l=s_oSpriteLibrary.getSprite("but_exit");t={x:CANVAS_WIDTH-l.height/2-10,y:l.height/2+10},o=new CGfxButton(t.x,t.y,l,s_oStage),o.addEventListener(ON_MOUSE_UP,this._onExit,this);var l=s_oSpriteLibrary.getSprite("but_pause");if(i={x:t.x-l.height-10,y:t.y},s=new CGfxButton(i.x,i.y,l,s_oStage),s.addEventListener(ON_MOUSE_UP,this._onPause,this),DISABLE_SOUND_MOBILE===!1||s_bMobile===!1){var l=s_oSpriteLibrary.getSprite("audio_icon");e={x:i.x-l.height-10,y:t.y},r=new CToggle(e.x,e.y,l,s_bAudioActive,s_oStage),r.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this)}n={x:CANVAS_WIDTH/2-115,y:53},c=new createjs.Container,c.x=n.x,c.y=n.y,_=new createjs.Text("0","normal 36px "+FONT_GAME,"#000"),_.textAlign="left",_.textBaseline="alphabetic",_.outline=4,_.x=100,c.addChild(_),h=new createjs.Text("0","normal 36px "+FONT_GAME,TEXT_COLOR),h.textAlign="left",h.textBaseline="alphabetic",h.x=_.x,c.addChild(h),d=new createjs.Text(TEXT_SCORE,"normal 36px "+FONT_GAME,"#000"),d.textAlign="left",d.textBaseline="alphabetic",d.x=-50,d.outline=4,c.addChild(d),u=new createjs.Text(TEXT_SCORE,"normal 36px "+FONT_GAME,TEXT_COLOR),u.textAlign="left",u.textBaseline="alphabetic",u.x=d.x,c.addChild(u),f=new CRollingScore,g=new CCoinBoard(60,40),S=new CAreYouSurePanel(s_oStage),s_oStage.addChild(c),a=new CHelpPanel(0,0,s_oSpriteLibrary.getSprite("msg_box")),this.refreshButtonPos(s_iOffsetX,s_iOffsetY)},this.refreshButtonPos=function(a,l){o.setPosition(t.x-a,l+t.y),s.setPosition(i.x-a,l+i.y),DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||r.setPosition(e.x-a,l+e.y),c.y=n.y+l;var h=g.getStartPosition();g.setPosition(h.x+a,h.y+l)},this.unload=function(){o.unload(),o=null,s.unload(),s=null,null!==a&&a.unload(),S&&S.unload(),DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||(r.unload(),r=null),s_oInterface=null},this.createEndPanel=function(e,t){p=new CEndPanel(s_oSpriteLibrary.getSprite("end_panel"),e,t)},this.unloadHelpPanel=function(){null!==a&&(a.unload(),a=null)},this.createPauseInterface=function(){l=new CPause},this.unloadPause=function(){l.unload(),l=null},this._onAudioToggle=function(){createjs.Sound.setMute(s_bAudioActive),s_bAudioActive=!s_bAudioActive},this._onExit=function(){S.show()},this.refreshCoin=function(e){g.refresh("x "+e)},this.coinEffect=function(e){g.animCoinEffect(e)},this.refreshScore=function(e){f.rolling(h,_,e)},this._onPause=function(){s_oGame.unpause(!1),this.createPauseInterface(),createjs.Ticker.paused=!0},s_oInterface=this,this._init(),this}function CHelpPanel(e,t,i){var n,o,s,o,a,r=!1;this._init=function(e,t,i){n=createBitmap(i),n.x=.5*CANVAS_WIDTH,n.y=.5*CANVAS_HEIGHT,n.regX=.5*i.width,n.regY=.5*i.height,o=new createjs.Container,o.x=e,o.y=t,s=new createjs.Shape,s.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),s.alpha=.5,o.addChild(s),o.addChild(n),s_oStage.addChild(o),this.page1(),o.on("pressup",function(){s_oHelpPanel._onExitHelp()},null,!0),s_bMobile||(o.cursor="pointer")},this.page1=function(){var e=new createjs.Container;e.y=-20,o.addChild(e);var t,i=30;t=new createjs.Text(TEXT_HELP_INPUT,i+"px "+FONT_GAME,"#000000"),t.textAlign="center",t.textBaseline="middle",t.x=.5*CANVAS_WIDTH+25,t.y=.5*CANVAS_HEIGHT-45,t.outline=3,e.addChild(t);var n;n=new createjs.Text(TEXT_HELP_INPUT,i+"px "+FONT_GAME,TEXT_COLOR),n.textAlign="center",n.textBaseline="middle",n.lineWidth=600,n.x=t.x,n.y=t.y,e.addChild(n);var s=s_oSpriteLibrary.getSprite("player"),r=new CCharacter(n.x-90,t.y+40,s,o);r.changeState("fly"),r.setScale(.8),r.changeState("start_jump_help");var l;l=s_bMobile?s_oSpriteLibrary.getSprite("help_touch"):s_oSpriteLibrary.getSprite("help_mouse");var c=createBitmap(l);c.x=t.x+90,c.y=t.y,c.regX=.5*l.width,c.regY=.5*l.height,c.scaleX=c.scaleY=.7,e.addChild(c);var h;h=new createjs.Text(TEXT_HELP_COIN,i+"px "+FONT_GAME,"#000000"),h.textAlign="center",h.textBaseline="middle",h.lineWidth=400,h.x=.5*CANVAS_WIDTH+25,h.y=.5*CANVAS_HEIGHT+40,h.outline=3,e.addChild(h);var _;_=new createjs.Text(h.text,i+"px "+FONT_GAME,TEXT_COLOR),_.textAlign="center",_.textBaseline="middle",_.lineWidth=h.lineWidth,_.x=h.x,_.y=h.y,e.addChild(_);var u,d=s_oSpriteLibrary.getSprite("object_8"),S=2,g=7,f={images:[d],frames:{width:d.width/g,height:d.height/S,regX:d.width/2/g,regY:d.height/2/S},animations:{normal:[0,13,"normal",.5]}},p=new createjs.SpriteSheet(f);u=createSprite(p,"normal",d.width/2/g,d.height/2/S,d.width/g,d.height/S),u.x=.5*CANVAS_WIDTH-100,u.y=h.y,e.addChild(u);var E;E=new createjs.Text(TEXT_HELP_SPIKE,i+"px "+FONT_GAME,"#000000"),E.textAlign="center",E.textBaseline="middle",E.lineWidth=600,E.x=.5*CANVAS_WIDTH+25,E.y=.5*CANVAS_HEIGHT+125,E.outline=3,e.addChild(E);var O;O=new createjs.Text(E.text,i+"px "+FONT_GAME,TEXT_COLOR),O.textAlign="center",O.textBaseline="middle",O.lineWidth=600,O.x=E.x,O.y=E.y,e.addChild(O);var A,T=s_oSpriteLibrary.getSprite("object_6");A=createBitmap(T),A.x=.5*CANVAS_WIDTH-100,A.y=E.y,A.regX=T.width/2,A.regY=T.height/2,A.scaleX=A.scaleY=.6,e.addChild(A),this.animCog(A),createjs.Tween.get(o).to({alpha:1},300,createjs.Ease.cubicOut);var C=s_oSpriteLibrary.getSprite("but_continue");a=new CGfxButton(.5*CANVAS_WIDTH+160,.5*CANVAS_HEIGHT+140,C,e),a.addEventListener(ON_MOUSE_UP,this._onExitHelp,this),a.pulseAnimation(),s_oStage.addChild(o)},this.animCog=function(e){createjs.Tween.get(e,{loop:!0}).to({rotation:360},1e3).call(function(){e.rotation=0})},this.unload=function(){s_oStage.removeChild(o),s_oHelpPanel=null,o.off("click",function(){}),a.unload(),a=null},this._onExitHelp=function(){r||(r=!0,playSound("click",1,0),createjs.Tween.get(o).to({alpha:0},500).call(function(){s_oGame._onExitHelp()}))},s_oHelpPanel=this,this._init(e,t,i)}function CLevelObjects(e,t,i){var n,o,s,a;return this._init=function(e,t,i){a=PLATFORM_SPEED,o=i,s=new Array,n=new createjs.Container,n.x=e,n.y=t,o.addChild(n),o.setChildIndex(n,3)},this.addObject=function(e,t,i,o){s[i]=new CObject(e,t,i,o,n),e>ON_VISIBLE_X&&s[i].setVisible(!1)},this.setSpeed=function(e){a=e},this.setPosition=function(e,t){n.x=e,n.y=t},this.unload=function(){o.removeChild(n),n=null,s=null},this.unloadObjects=function(){for(var e=0;e<s.length;e++)n.removeChild(s[e]);s=null},this.unloadObject=function(e){s[e].unload(),s.splice(e,1);for(var t=0;t<s.length;t++)s[t].setID(t)},this.getObjectByID=function(e){return s[e]},this.manageObjects=function(){for(var e=0;e<s.length;e++){var t=s[e].getX()+a,i=s[e].getY();s[e].setPosition(t,i);var n=s[e].getX();ON_VISIBLE_X>n&&n>-s[e].getWidth()?s[e].setVisible(!0):s[e].setVisible(!1)}},this.collisionObjects=function(e){for(var t=e.rect,i=0;i<s.length;i++)s[i].getVisible()&&s[i].controlCollision(t)},this.update=function(e){this.manageObjects(),this.collisionObjects(e)},this._init(e,t,i),this}function trace(e){console.log(e)}function isIOS(){for(var e=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"];e.length;)if(navigator.platform===e.pop())return s_bIsIphone=!0,!0;return s_bIsIphone=!1,!1}function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler(),window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function getSize(e){var t,i=e.toLowerCase(),n=window.document,o=n.documentElement;if(void 0===window["inner"+e])t=o["client"+e];else if(window["inner"+e]!=o["client"+e]){var s=n.createElement("body");s.id="vpw-test-b",s.style.cssText="overflow:scroll";var a=n.createElement("div");a.id="vpw-test-d",a.style.cssText="position:absolute;top:-1000px",a.innerHTML="<style>@media("+i+":"+o["client"+e]+"px){body#vpw-test-b div#vpw-test-d{"+i+":7px!important}}</style>",s.appendChild(a),o.insertBefore(s,n.head),t=7==a["offset"+e]?o["client"+e]:window["inner"+e],o.removeChild(s)}else t=window["inner"+e];return t}function getIOSWindowHeight(){var e=document.documentElement.clientWidth/window.innerWidth;return window.innerHeight*e}function getHeightOfIOSToolbars(){var e=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return e>1?e:0}function sizeHandler(){if(window.scrollTo(0,1),$("#canvas")){var e,t=!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g);e=t?getIOSWindowHeight():getSize("Height");var i=getSize("Width");s_iScaleFactor=Math.min(e/CANVAS_HEIGHT,i/CANVAS_WIDTH);var n=CANVAS_WIDTH*s_iScaleFactor,o=CANVAS_HEIGHT*s_iScaleFactor,s=0;e>o?(s=e-o,o+=s,n+=s*(CANVAS_WIDTH/CANVAS_HEIGHT)):i>n&&(s=i-n,n+=s,o+=s*(CANVAS_HEIGHT/CANVAS_WIDTH));var a=e/2-o/2,r=i/2-n/2,l=CANVAS_WIDTH/n;(-EDGEBOARD_X>r*l||-EDGEBOARD_Y>a*l)&&(s_iScaleFactor=Math.min(e/(CANVAS_HEIGHT-2*EDGEBOARD_Y),i/(CANVAS_WIDTH-2*EDGEBOARD_X)),n=CANVAS_WIDTH*s_iScaleFactor,o=CANVAS_HEIGHT*s_iScaleFactor,a=(e-o)/2,r=(i-n)/2,l=CANVAS_WIDTH/n),s_iOffsetX=-1*r*l,s_iOffsetY=-1*a*l,a>=0&&(s_iOffsetY=0),r>=0&&(s_iOffsetX=0),null!==s_oInterface&&s_oInterface.refreshButtonPos(s_iOffsetX,s_iOffsetY),null!==s_oMenu&&s_oMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY),$("#canvas").css("width",n+"px"),$("#canvas").css("height",o+"px"),0>a?$("#canvas").css("top",a+"px"):$("#canvas").css("top","0px"),$("#canvas").css("left",r+"px")}}function createBitmap(e,t,i){var n=new createjs.Bitmap(e),o=new createjs.Shape;return t&&i?o.graphics.beginFill("#fff").drawRect(-t/2,-i/2,t,i):o.graphics.beginFill("#ff0").drawRect(0,0,e.width,e.height),n.hitArea=o,n}function createSprite(e,t,i,n,o,s){if(null!==t)var a=new createjs.Sprite(e,t);else var a=new createjs.Sprite(e);var r=new createjs.Shape;return r.graphics.beginFill("#000000").drawRect(-i,-n,o,s),a.hitArea=r,a}function randomFloatBetween(e,t,i){return"undefined"==typeof i&&(i=2),parseFloat(Math.min(e+Math.random()*(t-e),t).toFixed(i))}function shuffle(e){for(var t,i,n=e.length;0!==n;)i=Math.floor(Math.random()*n),n-=1,t=e[n],e[n]=e[i],e[i]=t;return e}function formatTime(e){e/=1e3;var t=Math.floor(e/60),i=e-60*t;i=parseFloat(i).toFixed(1);var n="";return n+=10>t?"0"+t+":":t+":",n+=10>i?"0"+i:i}function degreesToRadians(e){return e*Math.PI/180}function checkRectCollision(e,t){var i,n;return i=getBounds(e,.9),n=getBounds(t,.98),calculateIntersection(i,n)}function calculateIntersection(e,t){var i,n,o={},s={};return o.cx=e.x+(o.hw=e.width/2),o.cy=e.y+(o.hh=e.height/2),s.cx=t.x+(s.hw=t.width/2),s.cy=t.y+(s.hh=t.height/2),i=Math.abs(o.cx-s.cx)-(o.hw+s.hw),n=Math.abs(o.cy-s.cy)-(o.hh+s.hh),0>i&&0>n?(i=Math.min(Math.min(e.width,t.width),-i),n=Math.min(Math.min(e.height,t.height),-n),{x:Math.max(e.x,t.x),y:Math.max(e.y,t.y),width:i,height:n,rect1:e,rect2:t}):null}function getBounds(e,t){var i={x:1/0,y:1/0,width:0,height:0};if(e instanceof createjs.Container){i.x2=-(1/0),i.y2=-(1/0);var n,o,s=e.children,a=s.length;for(o=0;a>o;o++)n=getBounds(s[o],1),n.x<i.x&&(i.x=n.x),n.y<i.y&&(i.y=n.y),n.x+n.width>i.x2&&(i.x2=n.x+n.width),n.y+n.height>i.y2&&(i.y2=n.y+n.height);i.x==1/0&&(i.x=0),i.y==1/0&&(i.y=0),i.x2==1/0&&(i.x2=0),i.y2==1/0&&(i.y2=0),i.width=i.x2-i.x,i.height=i.y2-i.y,delete i.x2,delete i.y2}else{var r,l,c,h,_,u={};if(e instanceof createjs.Bitmap)_=e.sourceRect||e.image,u.width=_.width*t,u.height=_.height*t;else if(e instanceof createjs.Sprite)if(e.spriteSheet._frames&&e.spriteSheet._frames[e.currentFrame]&&e.spriteSheet._frames[e.currentFrame].image){var d=e.spriteSheet.getFrame(e.currentFrame);u.width=d.rect.width,u.height=d.rect.height,u.regX=d.regX,u.regY=d.regY}else i.x=e.x||0,i.y=e.y||0;else i.x=e.x||0,i.y=e.y||0;u.regX=u.regX||0,u.width=u.width||0,u.regY=u.regY||0,u.height=u.height||0,i.regX=u.regX,i.regY=u.regY,r=e.localToGlobal(0-u.regX,0-u.regY),l=e.localToGlobal(u.width-u.regX,u.height-u.regY),c=e.localToGlobal(u.width-u.regX,0-u.regY),h=e.localToGlobal(0-u.regX,u.height-u.regY),i.x=Math.min(Math.min(Math.min(r.x,l.x),c.x),h.x),i.y=Math.min(Math.min(Math.min(r.y,l.y),c.y),h.y),i.width=Math.max(Math.max(Math.max(r.x,l.x),c.x),h.x)-i.x,i.height=Math.max(Math.max(Math.max(r.y,l.y),c.y),h.y)-i.y}return i}function NoClickDelay(e){this.element=e,window.Touch&&this.element.addEventListener("touchstart",this,!1)}function playSound(e,t,i){if(DISABLE_SOUND_MOBILE===!1||s_bMobile===!1){var n=createjs.Sound.play(e,{loop:i,volume:t});return n}return null}function stopSound(e){DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||e.stop()}function playExistingSound(e){DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||e.play()}function setVolume(e,t){DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||(e.volume=t)}function setMute(e,t){DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||e.setMute(t)}function destroySound(e){DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||e.destroy()}function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}function getParamValue(e){for(var t=window.location.search.substring(1),i=t.split("&"),n=0;n<i.length;n++){var o=i[n].split("=");if(o[0]==e)return o[1]}}function distanceV2(e,t){var i=e.x-t.x,n=e.y-t.y,o=i*i+n*n;return o}function distanceSQRT(e,t){var i=e.x-t.x,n=e.y-t.y,o=i*i+n*n;return Math.sqrt(o)}function collisionRect(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function saveItem(e,t){localStorage.setItem(e,t)}function getItem(e){return localStorage.getItem(e)}function clearAllItem(){localStorage.clear()}function CAreYouSurePanel(e){var t,i,n,o,s,a;this._init=function(){s=new createjs.Container,s.visible=!1,a.addChild(s);var e;e=new createjs.Shape,e.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),e.alpha=.5,e.on("click",function(){}),s.addChild(e);var r=s_oSpriteLibrary.getSprite("msg_box"),l=createBitmap(r);l.x=.5*CANVAS_WIDTH,l.y=.5*CANVAS_HEIGHT,l.regX=.5*r.width,l.regY=.5*r.height,s.addChild(l),t=new createjs.Text(TEXT_ARE_SURE,"40px "+FONT_GAME,"#000"),t.x=CANVAS_WIDTH/2+25,t.y=250,t.textAlign="center",t.textBaseline="middle",t.outline=5,s.addChild(t),i=new createjs.Text(t.text,"40px "+FONT_GAME,TEXT_COLOR),i.x=t.x,i.y=t.y,i.textAlign="center",i.textBaseline="middle",s.addChild(i),n=new CGfxButton(CANVAS_WIDTH/2+145,400,s_oSpriteLibrary.getSprite("but_yes"),s),n.addEventListener(ON_MOUSE_UP,this._onButYes,this),o=new CGfxButton(CANVAS_WIDTH/2-120,400,s_oSpriteLibrary.getSprite("but_exit_big"),s),o.addEventListener(ON_MOUSE_UP,this._onButNo,this)},this.show=function(){s_oGame.unpause(!1),s.visible=!0},this._onButYes=function(){s_oGame.unpause(!0),s_oGame.onExit()},this._onButNo=function(){s_oGame.unpause(!0),s.visible=!1},this.unload=function(){n.unload(),o.unload()},a=e,this._init()}function CEndPanel(e,t,i){var n,o,s,a,r,l,c;return this._init=function(e,t,i){n=new createjs.Container,o=new createjs.Container,c=e.width,o.alpha=0,s=createBitmap(e),s.x=.5*CANVAS_WIDTH,s.y=.5*CANVAS_HEIGHT,s.regX=.5*e.width,s.regY=.5*e.height,o.addChild(s),a=new createjs.Shape,a.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),a.alpha=0,a.on("click",function(){}),n.addChild(a);var h,_,u,d,S,g;d=new createjs.Text(TEXT_SCORE,"32px "+FONT_GAME,"#000000"),d.textAlign="center",d.textBaseline="middle",d.x=568,d.y=152,d.outline=4,o.addChild(d),u=new createjs.Text(TEXT_SCORE,"32px "+FONT_GAME,TEXT_COLOR_1),u.textAlign="center",u.textBaseline="middle",u.x=d.x,u.y=d.y,o.addChild(u),_=new createjs.Text(t,"32px "+FONT_GAME,"#000000"),_.textAlign="center",_.textBaseline="middle",_.x=568,_.y=190,_.outline=4,o.addChild(_),h=new createjs.Text(t,"32px "+FONT_GAME,TEXT_COLOR_1),h.textAlign="center",h.textBaseline="middle",h.x=_.x,h.y=_.y,o.addChild(h),g=new createjs.Text(TEXT_BEST_SCORE+"\n"+i,"28px "+FONT_GAME,"#000000"),g.textAlign="center",g.textBaseline="middle",g.x=568,g.y=253,g.outline=4,o.addChild(g),S=new createjs.Text(g.text,"28px "+FONT_GAME,TEXT_COLOR_1),S.textAlign="center",S.textBaseline="middle",S.x=g.x,S.y=g.y,o.addChild(S),n.addChild(o),n.x=0,n.y=0,s_oStage.addChild(n);var f=s_oSpriteLibrary.getSprite("but_restart"),p=s_oSpriteLibrary.getSprite("but_home");r=new CGfxButton(450,475,p,o),r.addEventListener(ON_MOUSE_UP,this._onExit,this),l=new CGfxButton(665,475,f,o),l.addEventListener(ON_MOUSE_UP,this._onRestart,this),l.pulseAnimation(),createjs.Tween.get(a).to({alpha:.75},750,createjs.Ease.cubicOut),createjs.Tween.get(o).to({alpha:1},1e3,createjs.Ease.cubicOut).call(function(){s_iAdsLevel===NUM_LEVEL_FOR_ADS?($(s_oMain).trigger("show_interlevel_ad"),s_iAdsLevel=1):s_iAdsLevel++}),$(s_oMain).trigger("save_score",t),$(s_oMain).trigger("share_event",t)},this.unload=function(){var e=this;createjs.Tween.get(o).to({alpha:0},1e3,createjs.Ease.cubicIn).call(function(){e.unloadButton()})},this.unloadButton=function(){r.unload(),r=null,l.unload(),l=null},this.blockAllBut=function(){l.block(!0),r.block(!0)},this._onRestart=function(){this.blockAllBut(),this.unload(),createjs.Tween.get(a).to({alpha:1},1e3,createjs.Ease.cubicIn).call(function(){s_oGame.restartLevel(),s_oGame.changeState(GAME_STATE_PLAY),createjs.Tween.get(a).to({alpha:0},1e3,createjs.Ease.cubicOut).call(function(){s_oStage.removeChild(n)})})},this._onExit=function(){this.unload(),this.blockAllBut(),s_oGame.onExit()},this._init(e,t,i),this}var s_oMenu=null,CANVAS_WIDTH=1360,CANVAS_HEIGHT=640,EDGEBOARD_X=250,EDGEBOARD_Y=30,FPS=30,DISABLE_SOUND_MOBILE=!1,FONT_GAME="matizregular",TEXT_COLOR="#ffde00",TEXT_COLOR_1="#fff",CONFIRMATION_EXIT=0,CONFIRMATION_RESET=1,FPS_TIME=1e3/FPS,URL_LEVELS_SETTINGS="json/levels_settings.json",BG_TYPES=19,EASY=0,MEDIUM=1,HARD=2,CHARACTER_POSITION={x:310,y:580},SPEED_ANIMATION=0,FLUE_POWER=6,CHARECTER_LIMIT_Y=EDGEBOARD_Y,PLATFORM_SPEED_INCREASE=-.5,MS_ANIM_COIN=1e3,MAX_COIN_EFFECT_INSTANCE=9,GID_OBJECTS=[8,0,1,2,3,4,5,6,7],OFFSET_PLATFORM_COL_DIMENSION=[{x:0,y:0}],OFFSET_PLATFORM_COL_POINT=[{x:0,y:0}],OFFSET_HEIGHT_PLATFORM_CHRACTER=26,OFFSET_PLAYER_COL_DIMENSION={x:-140,y:-52},OFFSET_PLAYER_COL_POINT={x:170,y:37},TOLLERANCE_Y_FOR_ANIMATION=100,PLATFORM_Y_START=0,LOGO_Y_POS=.5*CANVAS_HEIGHT-80,FIRST_PLATFORM_X=0,LAST_PLATFORM_X=.2*CANVAS_WIDTH,PARALLAXE_OBJ_X_RANDOMIZE=-150,PARALLAXE_OBJ_X_REPOS=CANVAS_WIDTH+150,MAX_POS_X_RANDOM_PARALLAXE=150,MAX_SCALE_PARALLAXE=1,MIN_SCALE_PARALLAXE=.6,MAX_NUM_PARALLAXE=3,STATE_LOADING=0,STATE_MENU=1,STATE_HELP=1,STATE_GAME=3,SHOW_COLLISION_SHAPE=!1,COG_COLLISION_FACTOR=.27,OFFSET_RECT_ARRIVAL={x:10,y:150},OFFSET_ARRIVAL_POS={x:0,y:5},OFFSET_FLUE_COLLISION_DOWN={x:25,y:20,w:-55,h:-120},OFFSET_FLUE_COLLISION_UP={x:60,y:-80,w:-60,h:-120},GAME_STATE_HELP=0,GAME_STATE_PLAY=1,GAME_STATE_FINISH=2,GAME_STATE_GAMEOVER=3,GAME_STATE_ANIMATION=4,COLLISION_PLATFORM=0,COLLISION_WALL=1,COLLISION_NOTHING=2,PREVIEW_COLLISION=4,NUM_PARALLAX_BG=4,DECREASE_FACTOR_VOL_GAME_COMPLETED=.95,DECREASE_FACTOR_VOL_LEVEL_COMPLETED=.85,OFFSET_HEIGHT_COLLISION_PLATFORM=-2,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,ON_BUT_NO_DOWN=6,ON_BUT_YES_DOWN=7,ON_CONTROLLER_END=8,ON_CONTROLLER_REMOVE=9,ON_CONTROLLER_ROLL=10,EASE_CUBIC_OUT=1,ON_VISIBLE_X=CANVAS_WIDTH+20,PLATFORM_SPEED,NUM_LEVEL_FOR_ADS,s_oCharacter,s_bMobile,s_bAudioActive=!0,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_iAdsLevel=1,s_iScore,s_oTweenController,s_oDrawLayer,s_oStage,s_oMain,s_oSpriteLibrary,s_oSoundTrack,MS_ROLLING_SCORE=750,s_oGame;TEXT_GAMEOVER="GAME OVER",TEXT_COMMANDS="CONTROLS",TEXT_CREDITS_DEVELOPED="Developed by",TEXT_TOTAL_SCORE="TOTAL SCORE",TEXT_PAUSE="PAUSE",TEXT_ARE_SURE="ARE YOU SURE?",TEXT_SCORE="SCORE",TEXT_BEST_SCORE="BEST SCORE",TEXT_HELP_INPUT="FLY",TEXT_HELP_COIN="COLLECT",TEXT_HELP_SPIKE="AVOID",TEXT_RESET="ARE YOU SURE? ALL YOUR PREVIOUS SCORES WILL BE DELETED!",TEXT_LEVEL="LEVEL",TEXT_SHARE_IMAGE="200x200.jpg",TEXT_SHARE_TITLE="Congratulations!",TEXT_SHARE_MSG1="You collected <strong>",TEXT_SHARE_MSG2=" points</strong>!<br><br>Share your score with your friends!",TEXT_SHARE_SHARE1="My score is ",TEXT_SHARE_SHARE2=" points! Can you do better?";var s_oInterface=null,s_oHelpPanel=null,s_iOffsetX=0,s_iOffsetY=0;!function(e){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}(navigator.userAgent||navigator.vendor||window.opera),$(window).resize(function(){sizeHandler()}),window.addEventListener("orientationchange",onOrientationChange),NoClickDelay.prototype={handleEvent:function(e){switch(e.type){case"touchstart":this.onTouchStart(e);break;case"touchmove":this.onTouchMove(e);break;case"touchend":this.onTouchEnd(e)}},onTouchStart:function(e){e.preventDefault(),this.moved=!1,this.element.addEventListener("touchmove",this,!1),this.element.addEventListener("touchend",this,!1)},onTouchMove:function(e){this.moved=!0},onTouchEnd:function(e){if(this.element.removeEventListener("touchmove",this,!1),this.element.removeEventListener("touchend",this,!1),!this.moved){var t=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY);3==t.nodeType&&(t=t.parentNode);var i=document.createEvent("MouseEvents");i.initEvent("click",!0,!0),t.dispatchEvent(i)}
}},function(){function e(e){var i="visible",n="hidden",o={focus:i,focusin:i,pageshow:i,blur:n,focusout:n,pagehide:n};e=e||window.event,e.type in o?document.body.className=o[e.type]:(document.body.className=this[t]?"hidden":"visible","hidden"===document.body.className?s_oMain.stopUpdate():s_oMain.startUpdate())}var t="hidden";t in document?document.addEventListener("visibilitychange",e):(t="mozHidden")in document?document.addEventListener("mozvisibilitychange",e):(t="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",e):(t="msHidden")in document?document.addEventListener("msvisibilitychange",e):"onfocusin"in document?document.onfocusin=document.onfocusout=e:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=e}();